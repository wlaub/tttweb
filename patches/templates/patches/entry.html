
{% load tttcms_tags thumbnail %}

<div class="container-fluid entry accordion" id="accordion-{{entry.id}}" {% if collapse %}data-toggle="collapse" data-target="#collapse-{{entry.id}}" {%endif%}>

    <div class="row" style="margin-left:0;margin-right:0">

        {% if not hide_image %}
        <a href = "{{entry.images.all.first.image.url}}">
            <img src = "{{entry.images.all.first.image|thumbnail_url:'audio_file'}}" class="adaptive-thumbnail">
            </a>
        {% endif %}  

        <div class = "col" style="">

            {%if not hide_info%}
            <div class = "row">
            <h3>
                 <a href = {% url 'patches:detail' entry.id %}>               
                {{entry.name}}
                </a>
            </h3>
            <h3 class = "entry-date">
                {{entry.date}} &#xff5c; {{entry.date|timesince}} ago {{entry.meta.duration}}
            </h3>
            </div>
            {%endif%}

            {%if not hide_info%}
            <div class = "row">
                {% if entry.authors.all%}
                {% for author in entry.authors.all %}
                <a 
href="{% url 'patches:index' %}{% format_querystring request.GET 'tags' author=author.author.display_name %}">
                    {{author.author.display_name}}
                </a>
                {% endfor %}
                {% else %}
                No Authors
                {% endif %}
            </div>
            {%endif%}


            <div class = "row"> 
            <audio controls src="{{entry.recording.url}}" id="audioplayer-{{entry.pk}}" style="width:100%"></audio><br>
            </div>

            {% if not hide_info %}

            <div class = "row" style="margin-top:0.25em;">
            {% if entry.tags.all %}
            Tags: &nbsp;{% for tag in entry.tags.all %}
            <a 
href="{% url 'patches:index' %}{% format_querystring request.GET 'tags' tags=tag.name%}"
                class="tooltiplink{%if tag.name in taglist%} tag-selected{%endif%}">
                {{tag.name}}<div class="tooltiptext">{{tag.name}}: {{tag.summary}}</div>
            </a>
            {% if not forloop.last%}<div class="tagdiv"></div>{% endif %}
            {% endfor %}
            {% else %}
            No Tags
            {% endif %}
            </div>

            {%endif%}

        </div>
    </div>

    <!-- Expandable info -->

    {%if not hide_info%}
    <div class = "row {% if collapse %}collapse{%endif%}" id = "collapse-{{entry.id}}">
        <div class = "col">
        <h3> Description </h3>
        <p>
        {{entry.desc|render_markdown|safe}}
        </p>

        <h3> Images </h3>
        {% for image in entry.images.all %}
            <a href = "{{image.image.url}}">
                <img src = "{{image.image|thumbnail_url:'audio_file'}}" class="thumbnail">
            </a>
        {% endfor %}


        <h3>Attachments</h3>
        <ul>
        {% if entry.attachments.all%}

            {% for attach in entry.attachments.all %}
            <li><a href="{{attach.file.url}}"> {{attach.filename}} </a><br></li>
            {% endfor %}
        {% else %}
            No Attachments
        {% endif %}
        </ul>

        <h3>Associated Repositories</h3>
        <ul>
        {% if entry.repo_attachments.all%}

            {% for attach in entry.repo_attachments.all %}
            <li>{{attach.filename}}<br></li>
            {% endfor %}
        {% else %}
            No Associated Repositories
        {% endif %}
        </ul>



        </div>
    </div>
    {%endif%}

</div>
